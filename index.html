<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gallery Moodboard — Masonry</title>
  <style>
    /* --- Reset & base --- */
    :root{
      --bg: #0f172a;
      --card: #0b1220;
      --text: #e6eef8;
      --accent: #7c3aed;
      --gap: 16px;
      --max-width: 1200px;
    }
    *{box-sizing: border-box}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
    body{background:linear-gradient(180deg,var(--bg),#071029);color:var(--text);-webkit-font-smoothing:antialiased;padding:36px;}

    /* --- Page container --- */
    .gallery-container{
      max-width:var(--max-width);
      margin:0 auto;
    }

    .gallery-header{
      display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px;
    }
    .gallery-title{
      font-size:clamp(20px,3vw,28px);letter-spacing:0.6px;font-weight:700;
      display:flex;align-items:center;gap:12px
    }
    .gallery-sub{
      color:rgba(230,238,248,0.7);font-size:14px
    }

    /* --- Masonry using CSS columns --- */
    .gallery-grid{
      column-gap:var(--gap);
      width:100%;
      /* initial column count will be overridden by media queries */
      column-count:1;
    }

    /* Each item should avoid being split between columns */
    .gallery-item{
      display:inline-block;
      width:100%;
      margin:0 0 var(--gap) 0;
      break-inside:avoid;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;
      overflow:hidden;
      transform-origin:center bottom;
      box-shadow:0 6px 18px rgba(2,6,23,0.6);
      transition:transform 240ms cubic-bezier(.2,.9,.3,1), box-shadow 240ms;
    }

    .gallery-item:hover{transform:translateY(-6px) scale(1.005);box-shadow:0 18px 36px rgba(2,6,23,0.75)}

    .gallery-image{
      display:block;width:100%;height:auto;vertical-align:middle;
      opacity:0;transform:translateY(18px) scale(0.98) rotate(-0.5deg);filter:grayscale(0.02) saturate(1.02);
      transition:opacity 420ms ease, transform 420ms cubic-bezier(.2,.9,.3,1);
      will-change:opacity, transform;
    }

    /* visible animation class added by JS */
    .gallery-image.gallery-visible{
      opacity:1;transform:translateY(0) scale(1) rotate(0);
    }

    .gallery-caption{
      padding:10px 12px;font-size:13px;color:rgba(230,238,248,0.85);
      display:flex;align-items:center;justify-content:space-between;gap:8px
    }
    .gallery-tag{background:rgba(255,255,255,0.04);padding:6px 8px;border-radius:8px;font-weight:600;font-size:12px}

    /* --- Responsive column counts --- */
    @media(min-width:480px){.gallery-grid{column-count:2}}
    @media(min-width:768px){.gallery-grid{column-count:3}}
    @media(min-width:1100px){.gallery-grid{column-count:4}}

    /* --- Small tweaks for very small screens --- */
    @media(max-width:420px){
      body{padding:18px}
      .gallery-caption{font-size:12px;padding:8px}
    }

    /* --- Accessibility focus --- */
    .gallery-item:focus-within{outline:3px solid rgba(124,58,237,0.16)}

    /* a simple loader while images are being prepared */
    .gallery-loader{display:flex;align-items:center;gap:12px;color:rgba(230,238,248,0.7);margin-bottom:12px}
    .gallery-spinner{
      width:20px;height:20px;border-radius:50%;border:3px solid rgba(255,255,255,0.08);border-top-color:var(--accent);animation:spin 900ms linear infinite
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    /* subtle entrance for entire grid */
    .gallery-grid-wrap{opacity:0;transform:translateY(10px);transition:opacity 540ms ease,transform 540ms ease}
    .gallery-grid-wrap.gallery-ready{opacity:1;transform:none}

  </style>
</head>
<body>
  <div class="gallery-container">
    <header class="gallery-header">
      <div>
        <h1 class="gallery-title">Moodboard — <span style="color:var(--accent);text-transform:uppercase">Gallery</span></h1>
      </div>
      <div class="gallery-loader" aria-hidden="true"><div class="gallery-spinner"></div><div>loading gallery…</div></div>
    </header>

    <main class="gallery-grid-wrap">
      <section class="gallery-grid" id="gallery-grid">
        <!-- Items will be injected by JavaScript -->
      </section>
    </main>
  </div>

  <script>
    // JavaScript to populate ~60 images and run entrance animations
    (function(){
      const TOTAL = 60; // change to 50-60 as requested
      const grid = document.getElementById('gallery-grid');
      const loader = document.querySelector('.gallery-loader');
      const wrap = document.querySelector('.gallery-grid-wrap');

      // Generate an array of image URLs using picsum.photos seeded images to give variety
      const imgs = Array.from({length: TOTAL}, (_,i)=>{
        // choose size variations to create different heights
        const sizes = [ [400,600],[600,400],[500,700],[720,480],[480,720],[600,900],[900,600] ];
        const s = sizes[i % sizes.length];
        // seed for consistent random image per index
        return {
          src: `https://picsum.photos/seed/gallery-${i+1}/${s[0]}/${s[1]}`,
          alt: `Moodboard image ${i+1}`,
          tag: ['Design','Photo','Texture','Color','Inspiration','UI'][i % 6]
        }
      });

      // Build DOM nodes
      function createItem(obj, index){
        const item = document.createElement('article');
        item.className = 'gallery-item';
        item.setAttribute('tabindex','0');

        const img = document.createElement('img');
        img.className = 'gallery-image gallery-image-'+(index+1);
        img.loading = 'lazy';
        img.decoding = 'async';
        img.src = obj.src;
        img.alt = obj.alt;

        const cap = document.createElement('div');
        cap.className = 'gallery-caption';
        cap.innerHTML = `<div>${obj.alt}</div><div class="gallery-tag">${obj.tag}</div>`;

        item.appendChild(img);
        item.appendChild(cap);
        return item;
      }

      // Append all items
      imgs.forEach((it, idx)=>{
        grid.appendChild(createItem(it, idx));
      });

      // Once DOM images start loading, we'll stagger animations
      const images = Array.from(document.querySelectorAll('.gallery-image'));

      // When the first batch of images are 'loaded' or after a small timeout, remove loader and reveal grid
      let firstPaintTimeout = setTimeout(()=>{
        loader.style.display = 'none';
        wrap.classList.add('gallery-ready');
      }, 800);

      // Use IntersectionObserver to animate images when they are visible in viewport with a nice staggered delay
      const observer = new IntersectionObserver((entries, obs)=>{
        entries.forEach(entry=>{
          if(entry.isIntersecting){
            const img = entry.target;
            // find index from className fallback
            const classes = img.className.split(/\s+/);
            const idxClass = classes.find(c=>c.startsWith('gallery-image-')) || '';
            const idx = parseInt(idxClass.replace('gallery-image-','')) - 1 || 0;

            // stagger effect based on index but mod to limit long delays
            const delay = (idx % 12) * 60; // 0..660ms stagger pattern
            setTimeout(()=>{
              img.classList.add('gallery-visible');
            }, delay);

            obs.unobserve(img);
          }
        })
      },{root:null,rootMargin:'200px 0px 200px 0px',threshold:0.06});

      images.forEach(img=>observer.observe(img));

      // As a fallback, ensure all images become visible after a maximum time (in case some never intersect)
      setTimeout(()=>{
        images.forEach((img, i)=>{
          if(!img.classList.contains('gallery-visible')){
            img.classList.add('gallery-visible');
          }
        })
        loader.style.display = 'none';
        wrap.classList.add('gallery-ready');
        clearTimeout(firstPaintTimeout);
      }, 4200);

      // Optional: click / keyboard behavior to open a simple lightbox
      document.addEventListener('click', function(e){
        const target = e.target;
        if(target.classList && target.classList.contains('gallery-image')){
          openLightbox(target.src, target.alt);
        }
      });

      document.addEventListener('keydown', e=>{
        if(e.key === 'Enter' || e.key === ' '){
          const active = document.activeElement;
          if(active && active.querySelector && active.querySelector('.gallery-image')){
            const img = active.querySelector('.gallery-image');
            e.preventDefault();
            openLightbox(img.src, img.alt);
          }
        }
      })

      // create a minimal lightbox element lazily
      function openLightbox(src, alt){
        let lb = document.querySelector('.gallery-lightbox');
        if(!lb){
          lb = document.createElement('div');
          lb.className = 'gallery-lightbox';
          Object.assign(lb.style,{position:'fixed',inset:0,display:'flex',alignItems:'center',justifyContent:'center',background:'rgba(2,6,23,0.85)',zIndex:9999});
          const img = document.createElement('img');img.style.maxWidth='92%';img.style.maxHeight='92%';img.style.boxShadow='0 18px 40px rgba(0,0,0,0.7)';img.style.borderRadius='10px';
          const close = document.createElement('button');close.textContent='✕';Object.assign(close.style,{position:'absolute',top:'22px',right:'22px',background:'transparent',color:'#fff',border:'none',fontSize:'22px',cursor:'pointer'});
          lb.appendChild(img);lb.appendChild(close);
          document.body.appendChild(lb);
          close.addEventListener('click', ()=>{lb.remove()});
          lb.addEventListener('click', (ev)=>{ if(ev.target === lb) lb.remove() });
        }
        const lbImg = lb.querySelector('img');
        lbImg.src = src; lbImg.alt = alt;
      }

    })();
  </script>
</body>
</html>
